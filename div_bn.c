
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <openssl/bn.h>
#include <openssl/rsa.h>


static const char modulus[] = "00CD5F8A24C7605008897A3C922C0E812E769DE0A46442C350CB78C7868539F3D38AAC80B3E6A506605910E8599806B4D1D148F2F6B81DA04796A8A5AEE18F29E83E16775A2A0A00870541F6574ED1438636AE0A0C116E07104F48F72094863A3869E1C8FC220627278962FB22873E3156F18E55DEC94E970064EC7F4E0E88454012E2FD5DFE5F8D19BF170F9CCB3F46E0FD1019BCB02D9083A0703C617F996379E6478354A73AE6E6ACBCE1F4333ECFAF24366A3E977D3CD3CBFE8D8A387BD876BFDAB8488F6F47BF1FBE33010FD2D7E22B4DB2E567783CE0B606DB86B93759714C4F6396A7FB9F74C4021043B0F3D46D2633EBD43A877863DF7D680F506587C119DD64100CA831CE2AF33D951B524C5F06B49F5BF2CB381E74181930D06A80505C06ABD5BF4870F0C9FB581BD80DBA889660639F936EDEA8FE5D0C9EAE58062ED693252583C71CC782BA613E01438E69B43F9E64ECA84F9EA04E811AD7B39EFD7876D1B6B501C4F48ACCE6F24239F6C04028788135CD88C3D15BE0F2EBB7DE9E9C19A7A93037005EE0A9A640BADA332EC0D05EE9F08A832354A0487A927D5E88066E2569E6C5D4688E422BFA0B27C6171C6D7BF029BFD9165752AF19AA71B33A1EA70B6C371FB21E47F527D80B7D04F582AD9F9935AF723682DC01CA9880621870DECB7AD15648CDF4EF153016F3E6D87933B8EC54CFA1FDF87C467020A3E753";


int main(int argc, char **argv)
{
    int ret = EXIT_FAILURE;
    char *resultat = NULL, *reste = NULL;

    BIGNUM *bn1 = NULL;
    BIGNUM *bn2 = NULL;
    BIGNUM *dv = NULL;
    BIGNUM *rem = NULL;

    BN_CTX *ctx = BN_CTX_new();

    if (argc == 1)
    {
	printf("Usage: %s <p>\n", argv[0]);
	goto exit;
    }

    BN_hex2bn(&bn1, modulus);
    BN_hex2bn(&bn2, argv[1]);

    dv = BN_new();
    rem = BN_new();

    if (BN_div(dv, rem, bn1, bn2, ctx))
    {
      resultat = BN_bn2hex(dv);
      reste = BN_bn2hex(rem);

      printf("RESULTAT:\n%s\nRESTE:\n%s\n", resultat, reste);

      ret = EXIT_SUCCESS;

    }

 exit:

    BN_CTX_free(ctx);

    return ret;

}
